function PowermailBackend(e){"use strict";this.initialize=function(){i(),t(),n(),a(),o(),l(),s(),r(),c(),d(),f(),u(),p(),v(),h()};var i=function(){e('*[data-action="openPowermailDetails"]').click(function(){var i=e(this);i.closest("tr").find(".icon:first").toggle();var t=i.closest("tr").find(".openPowermailDetailsIcons .icon:last");t.is(":visible")?t.css("display","none"):t.css("display","inline-block"),i.closest("tr").next().toggleClass("powermail_listbe_details_closed").find(".powermail_listbe_details_container").slideToggle()})},t=function(){e(document).on("click",".unhideMail, .hideMail",function(){var i=e(this),t=i.closest("td").find(".container_module_uri").val(),n=i.closest("td").find(".container_uid").val(),a=i.closest("td").find(".container_table").val(),o=m(i.closest("tr"));_(a,n,o,t)})},n=function(){e(document).on("click",'*[data-action="deleteMail"]',function(){var i=e(this),t=i.closest("td").find(".container_module_uri").val(),n=i.closest("td").find(".container_uid").val(),a=i.closest("td").find(".container_table").val(),o=i.closest("td").find(".container_label_delete_confirmation").val();confirm(o)&&(g(i.closest("tr")),w(a,n,t))})},a=function(){e(".powermail_list .pagination a").click(function(i){i.preventDefault();for(var t=e(this).prop("href"),n=t.split("&"),a="",o=0;o<n.length;o++)n[o].indexOf("widget")!==-1&&(a=n[o]);if(""!==a){var l=a.split("=");l[0]=l[0].replace("%40","@");var s='<input type="hidden" name="'+l[0]+'" value="'+l[1]+'" />',r=e("#powermail_module_search");r.append(decodeURI(s)),r.submit()}return!1})},o=function(){e("a.sorting").click(function(i){i.preventDefault();for(var t=e(this).prop("href"),n=t.split("&"),a="",o=0;o<n.length;o++)n[o].indexOf("sorting")!==-1&&(a=n[o]);if(""!==a){var l=a.split("=");l[0]=l[0].replace("%40","@");var s=e('.extended_export_sorting_container[name="'+decodeURI(l[0])+'"]');s.length&&s.remove();var r='<input type="hidden" name="'+l[0]+'" value="'+l[1]+'" />',c=e("#powermail_module_search");c.append(decodeURI(r)),c.submit()}})},l=function(){e(".addPowermailSelection").click(function(){C(e(this)),b()})},s=function(){e(".addPowermailSelectionAll").click(function(){e(".addPowermailSelection").each(function(){C(e(this))}),b()})},r=function(){e(".powermailSelectionDelete").click(function(){k()})},c=function(){e(".powermailSelectionHide").click(function(){y(e)})},d=function(){e("#extended_search input, #extended_search select").not('*[type="submit"]').each(function(){if(""!==e(this).val())return void e("#extended_search").addClass("in")})},f=function(){e.fn.datetimepicker&&(e('input[data-datepicker="true"]').each(function(){var i=e(this),t=!0,n=!0;"date"===i.data("datepicker-settings")?n=!1:"time"===i.data("datepicker-settings")&&(t=!1),i.datetimepicker({format:i.data("datepicker-format"),timepicker:n,datepicker:t,lang:"en",i18n:{en:{months:i.data("datepicker-months").split(","),dayOfWeek:i.data("datepicker-days").split(",")}}})}),e('*[data-datepicker-opener="true"]').click(function(){e(this).prev().datetimepicker("show")}))},u=function(){e(".export_icon_xls, .export_icon_csv").click(function(){e(this).hasClass("export_icon_csv")&&e("#forwardToAction").val("exportCsv"),e(this).hasClass("export_icon_xls")&&e("#forwardToAction").val("exportXls"),e(this).closest("form").submit()}),e('*[data-action="searchall_submit"]').click(function(){e("#forwardToAction").val("list")}),e(".extended_export_title").click(function(){var i=e(this);i.hasClass("powermail-close")?(i.removeClass("powermail-close").addClass("powermail-open").children("span").removeClass("t3-icon-move-down").addClass("t3-icon-move-up"),i.next().slideDown("",function(){i.next().children("div").children("div").fadeTo("slow",1)})):(i.removeClass("powermail-open").addClass("powermail-close").children("span").removeClass("t3-icon-move-up").addClass("t3-icon-move-down"),i.next().children("div").children("div").fadeTo("slow",0,function(){i.next().slideUp()}))}),e(function(){e(".extended_export_field, .extended_export_field_container").sortable({connectWith:".connected",update:function(i,t){var n=e(this).prop("id");if("export_field_selection"===n){var a=e(this).sortable("toArray").toString();e("#export_fields").val(a)}}}).disableSelection()})},p=function(){e(".openHiddenTable").click(function(){var i=e(this).closest("tr");i.find(".dots").toggle(),i.find(".hiddenConverterTable").toggle()})},v=function(){e(".powermail_listbe_details_dd.powermail_listbe_details_type_password").html("********")},h=function(){var i=e(".powermail_reporting_form_fields_table");i.find("tr:even").addClass("even"),i.find("tr:first").removeClass("even"),i.find("tr").hide(),i.find("tr:first").show(),i.find("th").click(function(){var i=e(this);i.hasClass("powermail-close")?i.removeClass("powermail-close").addClass("powermail-open"):i.removeClass("powermail-open").addClass("powermail-close"),i.parent().siblings().slideToggle("fast")}),e('*[data-flot-active="1"]').each(function(){for(var i=e(this),t=[],n=T(i.data("flot-data-values"),","),a=T(i.data("flot-data-labels"),","),o=T(i.data("flot-data-colors"),","),l=0;l<n.length;l++){var s={data:n[l],label:a[l],color:o[l]};t.push(s)}e.plot(i,t,{series:{pie:{show:!0,innerRadius:.5,radius:1,opacity:.3,color:"#FF0000",label:{show:!0,radius:1,formatter:I,background:{opacity:.8}},combine:{color:"#999",threshold:.1}}},grid:{hoverable:!0,clickable:!0}}),i.bind("plothover",function(i,t,n){if(n){var a=parseFloat(n.series.percent).toFixed(2);e("#hover").html("<span style='font-weight:bold; color:"+n.series.color+"'>"+n.series.label+" ("+a+"%)</span>")}}),i.bind("plotclick",function(e,i,t){if(t){var n=parseFloat(t.series.percent).toFixed(2);alert(""+t.series.label+": "+n+"%")}})})},m=function(e){var i=e.find(".visibilityButton"),t=0;return i.hasClass("unhideMail")?(i.removeClass("unhideMail").removeClass("fa-toggle-off").addClass("hideMail").addClass("fa-toggle-on"),e.find(".powermailRecordIcon").children(":first").removeClass("hide"),e.find(".powermailRecordIcon").children(":last").addClass("hide")):(i.removeClass("hideMail").removeClass("fa-toggle-on").addClass("unhideMail").addClass("fa-toggle-off"),e.find(".powermailRecordIcon").children().last().removeClass("hide"),e.find(".powermailRecordIcon").children().first().addClass("hide"),t=1),t},_=function(i,t,n,a){var o=a+"&data["+i+"]["+t+"][hidden]="+n+"&redirect="+T3_THIS_LOCATION;e.ajax({url:o})},w=function(i,t,n){var a=n+"&cmd["+i+"]["+t+"][delete]=1&redirect="+T3_THIS_LOCATION;e.ajax({url:a})},g=function(e){e.fadeOut("slow",function(){e.next().remove(),e.remove()})},C=function(e){e.hasClass("fa")?e.toggleClass("fa-plus").toggleClass("fa-minus").closest("tr").toggleClass("selectLine"):e.toggleClass("t3-icon-view-table-expand").toggleClass("t3-icon-view-table-collapse").closest("tr").toggleClass("selectLine")},b=function(){var i=e(".selectLine").length;e(".selectedLineMessage_numbers").html(i),i>0?e(".selectedLineMessage").show():e(".selectedLineMessage").hide()},k=function(){e(".selectLine").each(function(){var i=e(this),t=i.children(":last"),n=t.find(".container_module_uri").val(),a=t.find(".container_uid").val(),o=t.find(".container_table").val();w(o,a,n),g(i),x(i)}),b()},x=function(e){var i=e.find(".addPowermailSelection");C(i)},y=function(){e(".selectLine").each(function(){var i=e(this),t=i.children(":last"),n=t.find(".container_module_uri").val(),a=t.find(".container_uid").val(),o=t.find(".container_table").val();_(o,a,m(i),n),x(i)}),b()},T=function(e,i){if(e.toString().indexOf(i)!==-1)var t=e.split(i);else t=[e];return t},I=function(e,i){return'<div class="flotLabel">'+e+"<br/>"+Math.round(i.percent)+"%</div>"};window.PowermailBackend=PowermailBackend}jQuery(document).ready(function(e){var i=new window.PowermailBackend(e);i.initialize()});